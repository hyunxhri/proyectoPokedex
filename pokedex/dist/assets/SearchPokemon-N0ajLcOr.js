import{_ as b,L as g,R as w,a as h,c as d,b as a,d as e,t as l,e as x,f as C,w as m,F as N,r as c,o as _,p as B,g as P}from"./index-Bv-oI6JQ.js";import{R as y}from"./RightButtons-PgbPVb6b.js";async function S(){try{const t=await fetch("http://localhost:8080/api/pokemons/random");if(!t.ok)throw new Error("Failed to fetch random Pokemon");return await t.json()}catch(t){throw new Error("Error fetching random Pokemon:",t)}}const M={components:{LeftBar:g,RightButtons:y,RouterLink:w},data(){return{isButtonDisabled:!0,pokemon:null,isCapturedMsg:""}},methods:{async fetchNewPokemon(){try{this.pokemon=await S();const t=JSON.parse(localStorage.getItem("auth"));if(!t||!t.user||!t.user.token)throw new Error("No se encontró un token de autenticación");const o=t.user.token;await h.put(`http://localhost:8080/api/pokedex/pokemons/${this.pokemon.pokemonId}`,{seen:!0},{headers:{Authorization:`Bearer ${o}`}})}catch(t){console.error("Error al obtener un nuevo pokemon:",t)}},async tryToCapture(){if(Math.floor(Math.random()*100)+1<50){this.isCapturedMsg="¡Enhorabuena, lo has capturado!";const o=JSON.parse(localStorage.getItem("auth")).user.token;await h.put(`http://localhost:8080/api/pokedex/pokemons/${this.pokemon.pokemonId}`,{captured:!0},{headers:{Authorization:`Bearer ${o}`}}).then(()=>{setTimeout(()=>{this.isCapturedMsg="",this.fetchNewPokemon()},2e3)}).catch(u=>{console.log(u)})}else this.isCapturedMsg="Oh, no, ¡el pokemon ha huido!",setTimeout(()=>{this.isCapturedMsg="",this.fetchNewPokemon()},2e3)}},async mounted(){await this.fetchNewPokemon(),console.log(this.pokemon)}},i=t=>(B("data-v-b6a84038"),t=t(),P(),t),R={class:"screen"},I={class:"screen__capture-pokemon"},L=["src"],E={key:0,class:"screen__captured-text"},v={class:"screen__text-buttons"},T={class:"screen__text-buttons--text"},V=i(()=>e("br",null,null,-1)),A={class:"screen__buttons"},D=i(()=>e("button",{class:"screen__buttons--button"},"Pokedex",-1)),F=i(()=>e("button",{class:"screen__buttons--button"},"Profile",-1));function O(t,o,u,j,s,n){const k=c("LeftBar"),p=c("RouterLink"),f=c("RightButtons");return _(),d(N,null,[a(k),e("article",R,[e("section",I,[e("img",{class:"screen__img",src:s.pokemon?this.pokemon.img:"@/assets/imgs/bulbasaur.png",alt:"pokemon_img"},null,8,L),s.isCapturedMsg?(_(),d("p",E,l(s.isCapturedMsg),1)):x("",!0),e("div",v,[e("p",T,[C(" A wild "+l(s.pokemon?this.pokemon.name:"Loading...")+" just appeared! ",1),V]),e("button",{class:"screen__text-buttons--button",onClick:o[0]||(o[0]=(...r)=>n.tryToCapture&&n.tryToCapture(...r))},"Capture"),e("button",{class:"screen__text-buttons--button",onClick:o[1]||(o[1]=(...r)=>n.fetchNewPokemon&&n.fetchNewPokemon(...r))},"Search other")])]),e("div",A,[a(p,{to:"/pokedex"},{default:m(()=>[D]),_:1}),a(p,{to:"/profile"},{default:m(()=>[F]),_:1})])]),a(f,{"is-disabled":s.isButtonDisabled},null,8,["is-disabled"])],64)}const q=b(M,[["render",O],["__scopeId","data-v-b6a84038"]]);export{q as default};
